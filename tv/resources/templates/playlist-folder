<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      eventCookie="@@@eventCookie@@@" dtvPlatform="@@@dtvPlatform@@@">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Democracy Playlist View</title>

    <link href="resource:css/main.css" rel="stylesheet" type="text/css" />
    <script type="text/javascript" src="resource:templates/osxdnd.js" />
    <t:include filename="dynamic.js" />
    <t:execOnLoad><![CDATA[

sorts.resetSortBy()
playlist = views.db.getObjectByID(int(kargs['id']))
playlistView = playlist.getView()
playlist.setSearch(None)
thisPlaylistView = views.playlistFolders.filter(lambda x: x is playlist)
childrenView = views.playlists.filterWithIndex(indexes.byFolder, playlist)

def updateSearchString(newSearch):
    playlist.setSearch(newSearch)

def setSortBy(by, handle):
    sorts.setSortBy(by)
    playlist.recomputeSort()
]]>
    </t:execOnLoad>
    <t:execOnUnload><![CDATA[
thisPlaylistView.unlink()
]]>
</t:execOnUnload>
</head>
<body dragdesttype="playlist"
	dragdestdata="playlistfolder-***playlist.getID()***"
	drageffectplaylist="move"
	onkeydown="sendKeyToSearchBox(event);">
<div id="main-titlebar">
    <img id="main-icon" src="resource:images/folder-icon.png" alt="" />
    <div t:updateForView="thisPlaylistView">
        <h1 id="main-title" t:replace="playlist.getTitle()" />
    </div>
</div>

<div t:updateForView="playlistView">
<t:includeTemplate filename="sort-bar" />
</div>

<div id="main-container">
    <span t:updateForView="playlistView">
        <div t:hideIf="playlistView.len() == 0">
            <t:includeTemplate filename="sort-bar" />
        </div>
    </span>
    <div t:repeatForView="playlistView" t:repeatTemplate='download-item' />
    <div class="playlist-end-drag-hitbox"
	dragdesttype="downloadeditem"
	dragdestdata="playlistitem-END"
	drageffectdownloadeditem="move" />
</div>
<div t:updateForView="childrenView">
<div t:showIf="playlistView.len() == 0">
   <div class="channel-blank">
       <div t:showIf="childrenView.len() == 0">
            <div class="channel-message" i18n:translate="">
                Empty Playlist Folder
            </div>
        </div>
        <div t:showIf="childrenView.len() > 0">
            <div class="channel-message" i18n:translate="">
            This folder contains
            <span t:replace="childrenView.len()" i18n:name="count" />
            playlists, but the playlists do not contain any items.
            </div>
        </div>
        <div t:hideIf="childrenView.len() > 0">
            <div class="channel-message small" i18n:translate="">
                Drag playlists to this folder to add them.
            </div>
        </div>
    </div>
</div>
</div>
</body>
</html>
